<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="..."
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <style>
      /* Styling for the back button */
      #cat{
        padding: 10px 20px;
        background-color: rgba(255, 255, 255, 0.2);
        color: #ffffff;
        text-align: center;
        text-decoration: none;
        border-radius: 50px;
        margin-left: 100px;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.3s;
        font-family: Arial, sans-serif;
        font-size: 16px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
      }
    
      /* On mouse-over, change background color and add glass effect */
      #cat:hover {
        background-color: rgba(0, 105, 16, 0.248);
        backdrop-filter: blur(10px);
      
      }
    
      /* Responsive styling */
      @media screen and (max-width: 600px) {
        #cat{
          font-size: 14px;
          margin-left: 50px;
          padding-right:  50px;
        }
      }
    </style>
    
  <script>
    // JavaScript function to go back
    function goBack() {
      window.history.back();
    }
    </script>
    <style>
         
   /* Style for the container */
   .container89 {
            width: 100%;
            max-width: 1000px; /* Adjust the maximum width as needed */
            margin: 0 auto; /* Center the container */
            overflow: hidden; /* Clear floats */
        }

        /* Style for the block */
        .block89 {
            box-sizing: border-box;
            padding: 20px; /* Add some padding for spacing */
            border: 1px solid #ccc; /* Add a border for visualization */
            width: 100%; /* Set the width of the block to 100% by default */
            float: left;
            margin-bottom: 20px;
             /* Add margin to create a gap between blocks */
        }

        /* Media query for small devices */
        @media (max-width: 767px) {
            .block89 {
                margin-bottom: 10px; /* Adjust margin for smaller devices */
            }
        }

        /* Media query for medium devices (tablets) */
        @media (min-width: 768px) and (max-width: 991px) {
            .block89 {
                width: 48%; /* Adjusted width for tablets */
                margin-right: 4%; /* Add margin-right to create a gap between blocks */
            }
            .block89:nth-child(2n) {
                margin-right: 0; /* Remove margin-right for the last block in each row */
            }
        }

        /* Media query for larger devices (desktops) */
        @media (min-width: 992px) {
            .block89 {
                width: 48%; /* Adjusted width for larger screens */
                margin-right: 4%; /* Add margin-right to create a gap between blocks */
            }
            .block89:nth-child(2n) {
                margin-right: 0; /* Remove margin-right for the last block in each row */
            }
        }





         #unique-container {
            text-align: center;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            height: 400px;
           
            align-items: center;
            justify-content: center;
          
        }

        #unique-header  h1  {
            padding: 20px 20px;
            font-size: 25px;
        }

        #unique-message {
            margin-top: 10px;
        }

        #unique-button {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 10px;
            cursor: pointer;
            border-radius: 20px;
        }

        #unique-button:hover{
          color: #000000;
          padding: auto;
          margin: 12px;
          border-radius: 20px;
          background-color: aqua;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
          
        }
    </style>
    <style>
      
      .forecast-card {
        display: none;
      }
  
      .active {
        display: block;
      }
  
      .card-img-top {
        margin: 0 auto;
  
        
         /* Center the image */
        max-width: 40%; /* Adjust the maximum width of the image */
        height: auto;
      }
  
      
    </style>
     <style>
      /* Your default styles */
      #wea {
          text-align: center;
        
           color: #000000;
           font-size: 30px;
           padding: 20px 2px;
          /* Add any other styles you want for non-responsive */
      }
  
      
      </style>
    <title>Weather and Soil Data</title>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      async
    ></script>
    <style>
      body {
        background-image: url('/static/wp7401475-green-plant-wallpapers.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        background-attachment: fixed;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        background-color: #0000006a;
        flex: content;
      }

      h1,
      h2 {
        color: #02080f;
      }

      #rainMessage {
        margin-bottom: 20px;
      }

      #farmersMessage {
        margin-top: 20px;
      }
    </style>
  </head>

  <body>

    <button id="cat" onclick="goBack()">Back</button>
    <div style="background-color: #a3cc743f;" class="container md-9 mt-5">
      <br>
      <h1 class="mb-4 text-center" style="color: #ffffffdd;">Weather and Soil Data</h1>
      <!-- Search Input and Button -->
      <div class="text-center">
        <input id="searchInput" type="text" placeholder="Enter location..." style="width: 300px; padding: 10px;">
        <button onclick="searchWeather()" class="btn btn-primary">Search</button>
      </div>
      <br>
      <div class="row">
        <div class="col-md-6 mb-4">
          <!-- Weather Card -->
          <div class="card" style="background-color: #cfbfba67">
            <div class="card-body">
              <div id="weatherInfo"></div>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <!-- Soil Card -->
          <div class="card" style="background-color: #cfbfba67">
            <div class="card-body">
              <div id="soilInfo"></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Message Tip for Farmers -->
      <div id="rainMessage" class="notification"></div>
      <div id="farmersMessage" class="text-center"></div>
      <div id="weeklyForecast" class="text-center"></div>
    </div>
    <div class="container89">
      <div class="block89">
        <div class="justify-content-center" id="forecast-container"></div>
        <button style="margin: 35px;" class="btn btn-primary" onclick="prevSlide()">Previous Weather</button>
        <button class="btn btn-primary" onclick="nextSlide()">Next Weather</button>
      </div>
      <div class="block89">
        <div id="unique-container">
          <div id="unique-header">
            <h1 >Random Farm Tip</h1>
          </div>
          <p id="unique-message">Refresh the page to change</p>
          <button id="unique-button" onclick="generateRandomTip()">Get Another Tip</button>
        </div>
      </div>  
    </div>






<script>
  const farmTips = [
      
"When planting strawberries, space them well to ensure good airflow and reduce the risk of diseases.",
"For tomatoes, use a support system such as cages or stakes to prevent fruit from touching the ground.",
"Rotate fruit tree varieties to avoid soil-borne diseases specific to certain species.",
"Prune grapevines to remove excess foliage and improve air circulation, reducing the risk of mildew.",
"Utilize natural mulches like straw or wood chips around fruit and vegetable plants to retain soil moisture.",
"To enhance pollination, plant pollinator-friendly flowers near vegetable and fruit crops.",
"When cultivating herbs, harvest them regularly to encourage new growth and maintain flavor.",
"Practice proper spacing when planting vegetables to allow for good air circulation and sunlight penetration.",
"Consider planting a variety of colors and types of vegetables to create a visually appealing and diverse garden.",
"Protect young seedlings from pests by using row covers or applying natural insect repellents.",
"For container gardening, use high-quality potting mix with added nutrients to support plant growth.",
"Harvest zucchini and other summer squash when they are small and tender for the best flavor.",
"Utilize crop rotation with legumes to naturally enrich the soil with nitrogen.",
"When growing peppers, provide support for the plants as they may become top-heavy with fruit.",
"Integrate beneficial nematodes into the soil to control harmful nematode populations.",
"Harvest leafy greens, like lettuce and kale, by picking outer leaves to encourage continuous growth.",
"Use floating row covers to protect crops from early and late-season frost.",
"When cultivating pumpkins, leave a portion of the stem attached to the fruit to prolong storage life.",
"Practice proper irrigation by watering the base of plants to prevent fungal diseases on leaves.",
"For orchards, create a diverse ecosystem by incorporating native plants and encouraging beneficial wildlife.",
      // ... (same array as before)
  ];

  // Function to generate a random farm tip
  function generateRandomTip() {
      const randomIndex = Math.floor(Math.random() * farmTips.length);
      const farmTipElement = document.getElementById("unique-message");
      farmTipElement.textContent = farmTips[randomIndex];
  }

  // Initial load
  generateRandomTip();
</script>

    <script>
      const apiKey = '385afb2257bf981aa9f95b03ecf865d2';
      const apiUrl = 'https://api.agromonitoring.com/agro/1.0/weather/forecast';
      let data; // Variable to store forecast data
  
      // Function to convert Kelvin to Celsius
      const kelvinToCelsius = kelvin => (kelvin - 273.15).toFixed(2);
  
      // Function to format date in 12 hr format
      const format12hrTime = unixTimestamp => {
        const date = new Date(unixTimestamp * 1000);
        return date.toLocaleTimeString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true });
      };
  
      // Function to get the forecast
      const getForecast = (lat, lon) => {
        const apiUrlWithParams = `${apiUrl}?lat=${lat}&lon=${lon}&appid=${apiKey}`;
  
        fetch(apiUrlWithParams)
          .then(response => response.json())
          .then(result => {
            data = result;
            const forecastContainer = document.getElementById('forecast-container');
            forecastContainer.innerHTML = ''; // Clear previous content
  
            data.forEach((entry, index) => {
              const dateTime = new Date(entry.dt * 1000);
              const date = dateTime.toDateString();
              const time = format12hrTime(entry.dt);
              const tempMin = kelvinToCelsius(entry.main.temp_min);
              const tempMax = kelvinToCelsius(entry.main.temp_max);
              const humidity = entry.main.humidity;
              const windSpeed = entry.wind.speed;
              const cloudiness = entry.clouds.all;
              const weatherMain = entry.weather[0].main;
              const weatherDescription = entry.weather[0].description;
              const weatherIcon = `http://openweathermap.org/img/w/${entry.weather[0].icon}.png`;
  
              const forecastCard = `
                <div class="col-md-12  forecast-card ${index === 0 ? 'active' : ''}">
                  <div class="card">
                    <h1 class="text-center card-text " id="wea">5-Day Weather Forecast</h1>
                    <img src="${weatherIcon}" class="card-img-top" alt="Weather Icon">
                    <div class="card-body  justify-content-center">
                      <h5 class="card-title">${date}</h5>
                      <p class="card-text">${time}</p>
                      <p class="card-text">Weather: ${weatherMain}</p>
                      <p class="card-text">Description: ${weatherDescription}</p>
                      <p class="card-text">Min Temperature: ${tempMin}°C</p>
                      <p class="card-text">Max Temperature: ${tempMax}°C</p>
                      <p class="card-text">Humidity: ${humidity}%</p>
                      <p class="card-text">Wind Speed: ${windSpeed} m/s</p>
                      <p class="card-text">Cloudiness: ${cloudiness}%</p>
                    </div>
                  </div>
                </div>
              `;
  
              forecastContainer.innerHTML += forecastCard;
            });
  
            showSlide(0); // Display the first slide
          })
          .catch(error => console.error('Error fetching data:', error));
      };
  
      // Example coordinates (replace with your desired location)
      const latitude = 35;
      const longitude = 139;
  
      // Get the forecast for the specified coordinates
      getForecast(latitude, longitude);
  
      // Slideshow functionality
      let currentSlide = 0;
  
      function showSlide(index) {
        const slides = document.querySelectorAll('.col-md-12');
        slides.forEach((slide, i) => {
          if (i === index) {
            slide.style.display = 'block';
          } else {
            slide.style.display = 'none';
          }
        });
      }
  
      function nextSlide() {
        currentSlide = (currentSlide + 1) % data.length;
        showSlide(currentSlide);
      }
  
      function prevSlide() {
        currentSlide = (currentSlide - 1 + data.length) % data.length;
        showSlide(currentSlide);
      }
    </script>











































    <script>
      const apiKey1 = "385afb2257bf981aa9f95b03ecf865d2";

      const fetchData = async (url) => {
        const response = await fetch(url);
        return response.json();
      };

      const getGeoLocation = async () => {
        if (navigator.geolocation) {
          try {
            const position = await getCurrentPosition();
            const { latitude: lat, longitude: lon } = position.coords;
            const locationName = await getLocationName(lat, lon);

            const [currentWeather, forecastWeather, currentSoilData] =
              await Promise.all([
                fetchData(
                  `https://api.agromonitoring.com/agro/1.0/weather?lat=${lat}&lon=${lon}&appid=${apiKey1}`
                ),
                fetchData(
                  `https://api.agromonitoring.com/agro/1.0/weather/forecast?lat=${lat}&lon=${lon}&appid=${apiKey1}`
                ),
                fetchData(
                  `https://api.agromonitoring.com/agro/1.0/soil?lat=${lat}&lon=${lon}&appid=${apiKey1}`
                ),
              ]);

            const currentDate = new Date().toLocaleDateString();
            displayWeatherInfo(
              currentWeather,
              "Current Weather",
              currentDate,
              locationName
            );
            displayWeatherInfo(
              forecastWeather[0],
              "Forecast Weather",
              currentDate,
              locationName
            );
            displayWeeklyForecast(forecastWeather.slice(1, 8));
            displaySoilInfo(currentSoilData, locationName);
          } catch (error) {
            console.error("Error getting geolocation:", error);
          }
        } else {
          console.error("Geolocation is not supported by this browser.");
        }
      };

      const getCurrentPosition = () => {
        return new Promise((resolve, reject) => {
          navigator.geolocation.getCurrentPosition(resolve, reject);
        });
      };

      const getLocationName = async (lat, lon) => {
        try {
          const data = await fetchData(
            `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`
          );
          return data.locality;
        } catch (error) {
          console.error("Error getting location name:", error);
          return "";
        }
      };

      const displayFarmersMessage = (
        temperatureCelsius,
        humidity,
        windSpeed,
        soilTemperatureCelsius
      ) => {
        const farmersMessageElement = document.getElementById("farmersMessage");
        let message = "";

        if (temperatureCelsius > 25 && humidity < 70 && windSpeed < 5) {
          message = "Today is ideal for planting.";
        } else if (
          temperatureCelsius > 20 &&
          temperatureCelsius < 30 &&
          humidity > 60 &&
          soilTemperatureCelsius > 15
        ) {
          message = "Perfect day for weeding and fruit setting.";
        } else if (
          temperatureCelsius > 22 &&
          temperatureCelsius < 28 &&
          humidity < 65 &&
          windSpeed < 4
        ) {
          message = "Today is best for harvesting.";
        } else {
          message = "Consider soil preparation or storage activities today.";
        }

        farmersMessageElement.innerHTML = `<p class="bg-success text-white p-3 mt-3">Agro Tips : ${message}</p>`;
      };

      const displayWeatherInfo = (data, title, currentDate, locationName) => {
        const weatherInfoElement = document.getElementById("weatherInfo");
        const temperatureCelsius = (data.main.temp - 273.15).toFixed(2);

        // Get weather icon URL
        const iconUrl = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;

        const html = `
            <h2>${title}</h2>
        <div class="row">
          <img src="${iconUrl}" alt="Weather Icon" class=" card-img-top" style="width:150px; height:150px; ">
            <div class="col-md-6 order-2 order-md-1">
             
                <p>Date: ${currentDate}</p>
                <p>Location: ${locationName}</p>
                <p>Temperature: ${temperatureCelsius} °C</p>
                <p>Humidity: ${data.main.humidity} %</p>
                <p>Weather: ${data.weather[0].description}</p>
                <p>Wind Speed: ${data.wind.speed} m/s</p>
            </div>
        

          
        </div>
            `;

        weatherInfoElement.innerHTML = html;

        displayFarmersMessage(
          temperatureCelsius,
          data.main.humidity,
          data.wind.speed,
          temperatureCelsius
        );
      };

      const displaySoilInfo = (data, locationName) => {
        const soilInfoElement = document.getElementById("soilInfo");
        const surfaceTemperatureCelsius = (data.t0 - 273.15).toFixed(2);
        const temperatureAt10cmCelsius = (data.t10 - 273.15).toFixed(2);

        const html = `
                <h2>Current Soil Data</h2>
                <p>Location: ${locationName}</p>
                <p>Surface Temperature: ${surfaceTemperatureCelsius} °C</p>
                <p>Temperature at 10cm Depth: ${temperatureAt10cmCelsius} °C</p>
                <p>Soil Moisture: ${data.moisture} m3/m3</p>
            `;

        soilInfoElement.innerHTML = html;
      };









      const displayWeeklyForecast = (forecastData) => {
  const weeklyForecastElement = document.getElementById("weeklyForecast");
  let html = "</h2> <br>";

  html += '<div class="card-group">';

  let uniqueDays = new Set(); // Reset the set for each week
  let rainDates = [];

  forecastData.forEach((day) => {
    const { dt, dayOfWeek } = formatDate(day.dt);
    const minTemperatureCelsius = (day.main.temp_min - 273.15).toFixed(2);
    const maxTemperatureCelsius = (day.main.temp_max - 273.15).toFixed(2);

    if (day.rain && day.rain["3h"] > 0) {
      rainDates.push(`${dayOfWeek}, ${dt}`);
    }

    // Check if the day is not in the set and the total displayed days are less than 5
    if (!uniqueDays.has(dayOfWeek) && uniqueDays.size < 5) {
      html += `
       
      `;

      // Add the day to the set to mark it as displayed
      uniqueDays.add(dayOfWeek);
    }
  });

  html += "</div>";
  weeklyForecastElement.innerHTML = html;

  // Pass the rain dates to displayRainMessage
  displayRainMessage(rainDates);
};












      




      const displayRainMessage = (rainDates) => {
        const rainMessageElement = document.getElementById("rainMessage");
        let message = "";

        if (rainDates.length === 0) {
          message = "No rain this week.";
        } else {
          message = `Rain forecasted on: ${rainDates.join(", ")}.`;
        }

        rainMessageElement.innerHTML = `<p class=" text-white p-3 mt-3" style="text-align:center; background-color:  #db0e0e51;">Rain report : ${message}</p> <br>`;
      };

      const formatDate = (timestamp) => {
        const date = new Date(timestamp * 1000);
        const options = { weekday: "long", month: "long", day: "numeric" };
        const formatter = new Intl.DateTimeFormat("en-US", options);

        return {
          dt: formatter.format(date),
          dayOfWeek: formatter
            .formatToParts(date)
            .find((part) => part.type === "weekday").value,
        };
      };

      getGeoLocation();
    </script>






<script>
  // New function to search weather data based on input location
  async function searchWeather() {
    const location = document.getElementById('searchInput').value;
    try {
      const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?localityName=${location}&localityLanguage=en`);
      const locationData = await response.json();
      const { latitude, longitude } = locationData;
      const [currentWeather, forecastWeather, currentSoilData] = await Promise.all([
        fetchData(`https://api.agromonitoring.com/agro/1.0/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey1}`),
        fetchData(`https://api.agromonitoring.com/agro/1.0/weather/forecast?lat=${latitude}&lon=${longitude}&appid=${apiKey1}`),
        fetchData(`https://api.agromonitoring.com/agro/1.0/soil?lat=${latitude}&lon=${longitude}&appid=${apiKey1}`)
      ]);
      const currentDate = new Date().toLocaleDateString();
      displayWeatherInfo(currentWeather, "Current Weather", currentDate, location);
      displayWeatherInfo(forecastWeather[0], "Forecast Weather", currentDate, location);
      displayWeeklyForecast(forecastWeather.slice(1, 8));
      displaySoilInfo(currentSoilData, location);
    } catch (error) {
      console.error("Error searching weather data:", error);
    }
  }
</script>


    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      async
    ></script>
  </body>
</html>
